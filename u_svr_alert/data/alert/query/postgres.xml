<?xml version="1.0" encoding="UTF-8"?>
<sqlMap>
	<URL></URL>
	<DATABASE>postgres</DATABASE>
   	<HOSTNAME>10.0.55.141</HOSTNAME>
	<DBNAME>ecsdb</DBNAME>
   	<DBUSER>esp</DBUSER>
   	<DBPASSWORD>Zt+d3lC/P8z0uwxKPtIweg==</DBPASSWORD>
	<DBPORT>5432</DBPORT>

	<CREATE_ALERT_HISTORY>
		<![CDATA[
			CREATE TABLE C_ALERT_HISTORY (
				ID 			INT4 			NOT NULL,
				SITE 		VARCHAR(32) 	NOT NULL,
				JOBID 		VARCHAR(64) 	NOT NULL,
				LOGIN_ID 	VARCHAR(64),
				TITLE 		VARCHAR(256),
				CONTENT 	VARCHAR(1024),
				SENDER 		VARCHAR(64),
				RECEIVER 	VARCHAR(256),
				STATUS 		VARCHAR(64),
				RESULT      VARCHAR(64),
				CAUSE       VARCHAR(256),
				CMPLT_DT    TIMESTAMPTZ,
				REQ_DT      TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP NOT NULL,
				CONSTRAINT C_ALERT_HISTORY_PK PRIMARY KEY (ID),
				CONSTRAINT C_ALERT_HISTORY_UK UNIQUE  (SITE, JOBID, RECEIVER)
			)
		]]>
	</CREATE_ALERT_HISTORY>
	<CREATE_ALERT_HISTORY_SEQ>
		<![CDATA[
			CREATE SEQUENCE C_ALERT_HISTORY_SEQ INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE
		]]>
	</CREATE_ALERT_HISTORY_SEQ>
	<INSERT_ALERT_HISTORY>
		<![CDATA[
			INSERT INTO C_ALERT_HISTORY ( ID, SITE, JOBID, LOGIN_ID, TITLE, CONTENT, SENDER, RECEIVER, STATUS, RESULT, CAUSE, CMPLT_DT, REQ_DT ) VALUES
			(
				NEXTVAL('C_ALERT_HISTORY_SEQ'), #SITE#<STRING>, #JOBID#<STRING>, #LOGIN_ID#<STRING>, #TITLE#<STRING>, #CONTENT#<STRING>,
				#SENDER#<STRING>,  #RECEIVER#<STRING>,
				CASE
				WHEN #RESULT#<STRING> = 'FAIL' THEN 'COMPLETED'
				ELSE
					#STATUS#<STRING>
				END,
				#RESULT#<STRING>,
				#CAUSE#<STRING>,
				CASE
				WHEN #RESULT#<STRING> = 'FAIL' THEN CURRENT_TIMESTAMP
				ELSE
					NULL
				END,
				CURRENT_TIMESTAMP
			)
		]]>
	</INSERT_ALERT_HISTORY>
	<UPDATE_ALERT_HISTORY>
		<![CDATA[
			UPDATE C_ALERT_HISTORY SET RESULT = #RESULT#<STRING>, CAUSE = #CAUSE#<STRING>, STATUS = #STATUS#<STRING>,  CMPLT_DT = CURRENT_TIMESTAMP
			WHERE JOBID = #JOBID#<STRING>
		]]>
	</UPDATE_ALERT_HISTORY>

</sqlMap>